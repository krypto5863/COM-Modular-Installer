<link rel="icon" type="image/x-icon" href="/favicon.ico">

<script type="text/javascript">
    
async function GetDownload() {
    let result = await userAction();
    location.href = result.assets[0].browser_download_url;
}
    
async function fetchNotes(){
    const contentDiv = document.getElementById("changelog");
    let result = await userAction();   
    let html = await render(result.body);
    
    contentDiv.innerHTML = html;
}
    
async function fetchTag(){
    const contentDiv = document.getElementById("downloadButton");
    let result = await userAction();   
    
    contentDiv.innerHTML = contentDiv.innerHTML + ' ' + result.tag_name;
}

var ChangesHTML;
async function render(markdown) {
    
    if(ChangesHTML == null){  
        ChangesHTML = (await fetch('https://api.github.com/markdown', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({'mode': 'markdown', 'text': markdown})
        })).text();
       }
    return ChangesHTML;
    
}
    
var JsonFile;
var Calling;

const userAction = async () => {
    
  if(JsonFile == null && calling < 1)
  {
    calling = 1;
    console.log("Fetching Git stuff...");
    const response = await fetch('https://api.github.com/repos/krypto5863/COM-Modular-Installer/releases/latest');
    JsonFile = await response.json();
  }
  
  return JsonFile;
};
    
</script>
